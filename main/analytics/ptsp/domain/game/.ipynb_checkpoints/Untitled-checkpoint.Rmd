---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.3.2
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
from agent_2005 import *
from map import *
from ptsp_config import *
```

```{python}
m = Map(3,320,240,5)
```

```{python}
config = PTSPConfiguration()
```

```{python}
a = Agent(m, config)
```

```{python}
config.moves
```

```{python}
m.cities
```

```{python}
a.v
```

```{python}
all([True,False])
```

```{python}
def greedy(agent, m, i):
    x = agent.location[0]
    y = agent.location[1]
    v = agent.v
    a = m.cities[i][0]-x
    b = m.cities[i][1]-y
    b=b/abs(a)
    a=a/abs(a)
    f_min = 999999999999
    m_best = None
    for m in [(1,0),(-1,0),(0,1),(0,-1)]:
        v1 = v[0] + m[0]
        v2 = v[1] + m[1]
        f = (a-v1)*(a-v1)+(b-v2)*(b-v2)
        if f<f_min:
            f_min=f
            m_best=m
    return m_best
#     if abs(a)>abs(b):
#         if a>0:
#             return (1,0)
#         else:
#             return (-1,0)
#     else:
#         if b>0:
#             return (0,1)
#         else:
#             return (0,-1)
```

```{python}
i = 0
j = 0
while 1:
    j+=1
    move = greedy(a,m,i)
    a.update(move)
    m.try_visit(a.location[0],a.location[1],0)
#    print(a.location)
    if m.visited[i]:
        print(i,'city checked')
        i+=1
        if all(m.visited):
            print('End',j)
            m.reset()
            break
```

```{python}
m.save('m.sav')
```

```{python}
m=Map.load('m.sav')
```

```{python}
import sys
```

```{python}
sys.path.append('/home/matmozaur/Desktop/mgr/TSP-and-PTSP-Solver')
```

```{python}
from solution import *
```

```{python}
a = Agent(m, config)
i = 0
j = 0
solution = Solution([],m,config)
while 1:
    j+=1
    move = greedy(a,m,i)
    a.update(move)
    solution.moves.append(move)
    m.try_visit(a.location[0],a.location[1],0)
#    print(a.location)
    if m.visited[i]:
        print(i,'city checked')
        i+=1
        if all(m.visited):
            print('End',j)
            m.reset()
            break
```

```{python}
solution.check_solution()
```

```{python}
m2 = Map(3,320,240,5)
```

```{python}
solution.check_solution(map_ptsp=m2)
```

```{python}
solution.save('s.sav')
```

```{python}
solution=Solution.load('s.sav')
```

```{python}
solution.check_solution(map_ptsp=m2)
```

```{python}
solution.check_solution(map_ptsp=m)
```

```{python}

```
